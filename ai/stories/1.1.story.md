# Story 1.1: Next.js Project Setup

**Status:** Review

## Goal & Context

**User Story:** As a Developer, I want to set up the Next.js project with TypeScript and ESLint/Prettier configured, so that we have a clean codebase.

**Context:** This is the foundational story for Epic 1. It ensures the project starts with a clean, maintainable, and consistent coding environment. It involves verifying the initial Next.js and TypeScript setup, establishing robust linting and formatting rules with ESLint and Prettier, integrating these into pre-commit hooks using Husky, and creating the standard directory structure for future development.

## Detailed Requirements

Copied from `docs/epic1.md` (E1-S1):
As a Developer, I want to set up the Next.js project with TypeScript and ESLint/Prettier configured, so that we have a clean codebase.

## Acceptance Criteria (ACs)

Copied from `docs/epic1.md` (E1-S1):

- AC1: Next.js project initialized.
- AC2: TypeScript configured and working.
- AC3: ESLint and Prettier configured and integrated into pre-commit hooks.
- AC4: Basic project structure (folders for components, pages, services, etc.) created.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Refer to the linked `docs/` files for broader context if needed.

- **Relevant Files:**

  - Files to Create:
    - `src/components/` (directory)
    - `src/components/layout/` (directory for layout components like Header, Footer)
    - `src/components/ui/` (directory for shadcn/ui base components)
    - `src/components/features/` (directory for feature-specific components)
    - `src/lib/` (directory)
    - `src/lib/types/` (directory for shared TypeScript types)
    - `src/lib/utils.ts` (placeholder utility file)
    - `src/services/` (directory for backend business logic)
    - `src/hooks/` (directory for custom React hooks)
    - `src/providers/` (directory for React Context providers)
    - `src/config/` (directory for app-wide configuration)
    - `src/config/site.ts` (placeholder for site metadata, navigation links)
    - `.husky/` (directory for git hooks)
    - `.husky/pre-commit` (pre-commit hook script)
    - `.prettierrc.json` (Prettier configuration file. Example: `{ "semi": true, "singleQuote": true, "trailingComma": "es5", "printWidth": 100 }`)
    - `.eslintignore` (ESLint ignore file. Example content: `node_modules\n.next\nbuild\ncoverage\n*.config.js\n*.config.mjs`)
    - `.prettierignore` (Prettier ignore file. Example content: `package-lock.json\nnode_modules\n.next\nbuild\ncoverage`)
  - Files to Modify:
    - `package.json` (Add/update devDependencies for `husky`, `lint-staged`, `eslint-config-prettier`. Add scripts for `lint`, `format`, `prepare` (for husky)).
    - `eslint.config.mjs` (Ensure it aligns with `docs/coding-standards.md` including `eslint-config-next`, `typescript-eslint`, and integrates with Prettier using `eslint-config-prettier`. The project uses `eslint.config.mjs`, not `.eslintrc.json` as mentioned in some docs; update the existing file).
    - `.gitignore` (Ensure build artifacts like `.next/`, IDE folders, `.env.local`, and potentially `.husky/_/` are ignored).
  - _(Hint: See `docs/project-structure.md` for overall layout)_

- **Key Technologies:**

  - Next.js (current version in project)
  - TypeScript (current version in project)
  - ESLint (using existing `eslint.config.mjs`)
  - Prettier
  - Husky
  - lint-staged
  - _(Hint: See `docs/tech-stack.md` for full list)_

- **API Interactions / SDK Usage:**

  - Not applicable for this story.
  - _(Hint: See `docs/api-reference.md` for details on external APIs and SDKs)_

- **UI/UX Notes:** ONLY IF THIS IS A UI Focused Epic or Story

  - Not applicable for this story.

- **Data Structures:**

  - Not applicable for this story.
  - _(Hint: See `docs/data-models.md` for key project data structures)_

- **Environment Variables:**

  - Not applicable for this story.
  - _(Hint: See `docs/environment-vars.md` for all variables)_

- **Coding Standards Notes:**
  - Adhere to `docs/coding-standards.md`.
  - ESLint configuration is in `eslint.config.mjs`. Ensure it includes `eslint-config-prettier` to avoid conflicts with Prettier.
  - Prettier configuration should be stored in `.prettierrc.json`.
  - _(Hint: See `docs/coding-standards.md` for full standards)_

## Tasks / Subtasks

- [x] **Task 1: Verify Initial Next.js & TypeScript Setup**
  - [x] Confirm the existing Next.js project (`package.json`, `next.config.ts`, `src/app/`) is functional.
  - [x] Confirm TypeScript is correctly configured (`tsconfig.json`, `next-env.d.ts`) and basic TS files compile.
- [x] **Task 2: Configure ESLint**
  - [x] Review and update `eslint.config.mjs` to align with `docs/coding-standards.md`. Ensure it uses `eslint-config-next`, `@typescript-eslint/eslint-plugin`, `@typescript-eslint/parser`, and `eslint-config-prettier`.
  - [x] Create/update `.eslintignore` file.
  - [x] Add a lint script to `package.json` (e.g., `"lint": "next lint --fix"`).
- [x] **Task 3: Configure Prettier**
  - [x] Create `.prettierrc.json` with standard formatting rules (e.g., as suggested in "Files to Create").
  - [x] Create `.prettierignore` file.
  - [x] Add a format script to `package.json` (e.g., `"format": "prettier --write ."`).
- [x] **Task 4: Integrate ESLint & Prettier with Pre-commit Hooks**
  - [x] Install `husky` and `lint-staged` as dev dependencies.
  - [x] Initialize Husky (e.g., `npx husky init`, then update `package.json`'s `prepare` script to `husky install`).
  - [x] Configure `lint-staged` in `package.json` to run ESLint and Prettier on staged files (e.g., `{"*.{js,jsx,ts,tsx}": ["eslint --fix", "prettier --write"]}`).
  - [x] Create `.husky/pre-commit` hook script to run `npx lint-staged`.
- [x] **Task 5: Create Basic Project Directory Structure**
  - [x] Create the following directories under `src/`:
    - `components` (and its subdirectories: `layout`, `ui`, `features`)
    - `lib` (and its subdirectory: `types`)
    - `services`
    - `hooks`
    - `providers`
    - `config`
  - [x] Add placeholder files: `src/lib/utils.ts` and `src/config/site.ts`.
  - [x] Ensure `.gitignore` is updated if necessary for new directories or Husky files.

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests.

- **Unit Tests:**
  - Not directly applicable for project setup logic, but ensure linting and formatting commands can be run successfully.
- **Integration Tests:**
  - Not applicable for this story.
- **Manual/CLI Verification:**
  - Run the `lint` script from `package.json` and ensure it checks files correctly.
  - Run the `format` script from `package.json` and ensure it formats files correctly.
  - Attempt to commit a file with intentional linting/formatting errors. Verify that the pre-commit hook triggers, prevents the commit (or auto-fixes if configured), and reports errors.
  - Verify that all specified directories and placeholder files under `src/` are created correctly.
- _(Hint: See `docs/testing-strategy.md` for the overall approach)_

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** Gemini 2.5 Pro (via Cursor)
- **Completion Notes:** All tasks completed. Manual/CLI verification performed. Linting and formatting are functional, and the pre-commit hook is working as expected. Two ESLint warnings persist: 1) ".eslintignore is deprecated, use ignores in eslint.config.js" - an attempt to migrate was made, but the tool could not delete .eslintignore. The ignores are present in eslint.config.mjs. 2) "Next.js plugin was not detected" - this warning appeared after adding the global `ignores` block to `eslint.config.mjs`. Different configurations for `eslint.config.mjs` were attempted but did not resolve this specific warning. These warnings do not currently prevent linting from passing successfully. The `prettier` package was missing from devDependencies and has been added.
- **Change Log:**
  - Initial Draft
  - Story status updated to In-Progress.
  - Task 1 (Next.js/TS verification) completed.
  - Task 2 (ESLint config) completed: eslint.config.mjs updated, .eslintignore created, lint script updated.
  - Task 3 (Prettier config) completed: .prettierrc.json created, .prettierignore created, format script added.
  - Task 4 (Husky/lint-staged) completed: Dependencies installed, Husky initialized, lint-staged configured, pre-commit hook updated.
  - Task 5 (Directory structure) completed: Directories and placeholder files created, .gitignore updated.
  - ESLint ignores migrated to eslint.config.mjs from .eslintignore (though .eslintignore deletion failed).
  - `prettier` dev dependency installed.
  - Pre-commit hook verified.
  - Story status updated to Review.
