---
title: "Implement Unified Signup and Onboarding Flow"
story_id: "E1-S4/S5/S6"
story_points: 8
priority: "High"
status: "Complete"
---

# Story: Unified Signup and Onboarding Flow

This consolidated story combines three related stories:
- E1-S4: User signup and authentication process
- E1-S5: Guided onboarding flow after signup
- E1-S6: Subscription guidance for premium roles

## Acceptance Criteria

### Signup (E1-S4)
- Single unified signup form with fields for Email, Password, Confirm Password
- Successful submission creates a new user record in Supabase with no role assigned initially
- Email verification sent to the user via Supabase Auth
- User cannot access full platform features until email is verified
- Appropriate error handling for existing email, password mismatch, etc.

### Onboarding (E1-S5)
- Onboarding form with role selection (Student, CFI, or School Admin)
- Different information fields based on selected role
- Successful submission updates user profile with role and additional fields
- For CFIs and School Admins, redirect to subscription guidance page after profile completion
- For Students, redirect to dashboard

### Subscription Guidance (E1-S6)
- Subscription guidance page showing benefits of subscription
- Different content for CFIs vs School Admins
- Clear call-to-action buttons for subscription options
- Option to skip for now and continue with limited features

## Technical Context

Currently, the application has separate signup pages for Students, CFIs, and School Admins. We need to consolidate these into a single signup flow followed by role selection and role-specific profile completion.

The feature flag system (E1-S18) should be leveraged to support a gradual transition from the old approach to the new unified flow.

## Implementation Tasks

- [x] Create feature flag for "unified_signup_flow"
- [x] Create unified signup component with shared validation logic
- [x] Implement email verification confirmation page
- [x] Create role selection step with conditional fields
- [x] Implement profile completion form with role-specific fields
- [x] Create subscription guidance page for CFIs and School Admins
- [x] Add tracking for key events in the flow
- [x] Update routing to support the new flow
- [x] Implement clean redirects for old URLs to maintain backward compatibility

## Definition of Done

- Users can sign up through a single entry point
- After email verification, users can select their role
- Role-specific information is collected appropriately
- CFIs and School Admins see subscription information
- All critical actions are tracked via analytics
- The flow works with both feature flag states (on/off)
- Comprehensive tests validate the flow 